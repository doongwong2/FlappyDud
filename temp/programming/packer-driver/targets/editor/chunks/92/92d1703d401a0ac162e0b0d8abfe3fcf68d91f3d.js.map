{"version":3,"sources":["file:///C:/Users/User/Desktop/programs/FlappyDud/assets/Scripts/GameCtrl.ts"],"names":["_decorator","Component","Node","CCInteger","director","Contact2DType","Collider2D","Ground","Results","Bird","PipePool","ccclass","property","GameCtrl","type","tooltip","isOver","onLoad","initListener","result","resetScore","pause","node","on","EventType","TOUCH_START","resetGame","bird","resetBird","startGame","fly","hideResults","resume","gameOver","showResults","pipeQueue","reset","passPipe","addScore","createPipe","addPool","contactGroundPipe","collider","getComponent","BEGIN_CONTACT","onBeginContact","selfCollider","otherCollider","contact","hitSomething","birdStruck","update"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node , CCInteger, input, Input, EventKeyboard, KeyCode, director, Contact2DType, Collider2D, IPhysics2DContact} from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nimport { Ground } from './Ground';\r\nimport { Results } from './Results';\r\nimport { Bird } from './Bird';\r\nimport { PipePool } from './PipePool';\r\n\r\n@ccclass('GameCtrl')\r\nexport class GameCtrl extends Component {\r\n\r\n    @property({\r\n        type: Ground,\r\n        tooltip: 'this is ground'\r\n    })\r\n    public ground: Ground\r\n\r\n    @property({\r\n        type: Results,\r\n        tooltip:'results here'\r\n    })\r\n    public result: Results\r\n\r\n    @property({\r\n        type: Bird,\r\n        tooltip:'bird here'\r\n    })\r\n    public bird: Bird\r\n\r\n    @property({\r\n        type: PipePool\r\n    })\r\n    public pipeQueue: PipePool;\r\n\r\n    @property({\r\n        type: CCInteger\r\n    })\r\n    public speed: number = 300;\r\n\r\n    @property({\r\n        type: CCInteger\r\n    })\r\n    public pipeSpeed: number = 200;\r\n\r\n    public isOver : boolean;\r\n\r\n    onLoad(){\r\n        this.initListener();\r\n        this.result.resetScore();\r\n        this.isOver = true;\r\n        director.pause();\r\n    }\r\n\r\n    initListener(){\r\n        //input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this)\r\n\r\n        this.node.on(Node.EventType.TOUCH_START,() => {\r\n            if(this.isOver == true){\r\n                this.resetGame();\r\n                this.bird.resetBird();\r\n                this.startGame();\r\n            }\r\n\r\n            if(this.isOver == false){\r\n                this.bird.fly();\r\n            }\r\n        });\r\n    }\r\n\r\n    // onKeyDown(event: EventKeyboard){\r\n    //     switch(event.keyCode){\r\n    //         case KeyCode.KEY_A:\r\n    //             this.gameOver();\r\n    //             break;\r\n\r\n    //         case KeyCode.KEY_P:\r\n    //             this.result.addScore();\r\n    //             break;\r\n\r\n    //         case KeyCode.KEY_Q:\r\n    //             this.resetGame();\r\n    //             this.bird.resetBird();\r\n    //             break;\r\n    //     }\r\n    // }\r\n\r\n    startGame(){\r\n        this.result.hideResults();\r\n        director.resume();\r\n    }\r\n    \r\n    gameOver(){\r\n        this.result.showResults();\r\n        this.isOver = true;\r\n        director.pause();\r\n    }\r\n\r\n    resetGame(){\r\n        this.result.resetScore();\r\n        this.pipeQueue.reset();\r\n        this.isOver = false;\r\n        this.startGame();\r\n    }\r\n\r\n    passPipe(){\r\n        this.result.addScore();\r\n    }\r\n\r\n    createPipe(){\r\n        this.pipeQueue.addPool();\r\n    }\r\n\r\n    contactGroundPipe(){\r\n        let collider = this.bird.getComponent(Collider2D);\r\n\r\n        if(collider){\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n        }\r\n    }\r\n\r\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null){\r\n        this.bird.hitSomething =true;\r\n    }\r\n\r\n    birdStruck(){\r\n        this.contactGroundPipe();\r\n        if(this.bird.hitSomething == true){\r\n            this.gameOver();\r\n        }\r\n    }\r\n\r\n    update(){\r\n        if(this.isOver == false){\r\n            this.birdStruck();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}